import React, { useState } from 'react'
import { useForm } from 'react-hook-form'
import { useLocation, useNavigate, Link } from 'react-router-dom'
export default function Login(){ const { register, handleSubmit, formState:{ errors, isSubmitting } }=useForm(); const navigate=useNavigate(); const location=useLocation(); const [serverError,setServerError]=useState(''); const from=location.state?.from?.pathname||'/profile'; const onSubmit=async (data)=>{ setServerError(''); try{ await new Promise(r=>setTimeout(r,600)); if(!data.email||!data.password){ throw new Error('กรอกข้อมูลไม่ครบ') } localStorage.setItem('user', JSON.stringify({email:data.email})); navigate(from,{replace:true}) }catch(e){ setServerError(e.message||'เกิดข้อผิดพลาด') } }; return(<div className='min-h-[70vh] flex items-start justify-center pt-16'><div className='w-full max-w-md border rounded-xl p-8 shadow-soft bg-white'><h2 className='text-2xl font-bold text-center mb-2'>เข้าสู่ระบบ</h2><p className='text-center text-gray-600 mb-6'>กรอกอีเมลและรหัสผ่านเพื่อเข้าสู่ระบบ</p>{serverError&&<div className='mb-4 text-red-600 text-sm'>{serverError}</div>}<form onSubmit={handleSubmit(onSubmit)} className='space-y-4'><div><input type='email' placeholder='อีเมล' {...register('email',{required:'กรุณากรอกอีเมล'})}/>{errors.email&&<p className='text-red-600 text-sm mt-1'>{errors.email.message}</p>}</div><div><input type='password' placeholder='รหัสผ่าน' {...register('password',{required:'กรุณากรอกรหัสผ่าน'})}/>{errors.password&&<p className='text-red-600 text-sm mt-1'>{errors.password.message}</p>}</div><button disabled={isSubmitting} type='submit' className='w-full px-4 py-2 rounded-xl bg-black text-white disabled:opacity-60'>{isSubmitting?'กำลังส่ง…':'เข้าสู่ระบบ'}</button></form><p className='text-center text-sm mt-4 text-gray-600'>ยังไม่มีบัญชี? <Link to='/register' className='text-blue-600 hover:underline'>สมัครสมาชิก</Link></p></div></div>) }
